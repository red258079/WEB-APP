<!DOCTYPE html>
<html lang="vi">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- NgƒÉn tr√¨nh duy·ªát cache trang - b·∫£o m·∫≠t sau logout -->
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Dashboard Gi√°o Vi√™n</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
    <link rel="stylesheet" href="/client/public/css/teacher.css">
    <link rel="stylesheet" href="/client/public/css/scroll-to-top.css">
    <link rel="icon" type="image/png" href="/client/public/images/edu.png">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.8.1/socket.io.min.js"></script>
    <!-- Load config v√† API helpers tr∆∞·ªõc teacher.js -->
    <script src="/client/public/js/config.js"></script>
    <script src="/client/public/js/api.js"></script>
    <script src="/client/public/js/teacher_practice.js"></script>
    <script defer src="/client/public/js/teacher.js"></script>
    <script defer src="/client/public/js/teacher_materials.js"></script>
    <script defer src="/client/public/js/scroll-to-top.js"></script>
</head>

<body>
    <div class="sidebar-overlay" id="sidebarOverlay"></div>
    <div class="dashboard-container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-header">
                <h2>üìö EduManage</h2>
                <p>H·ªá th·ªëng qu·∫£n l√Ω thi</p>
            </div>
            <div class="sidebar-menu">
                <div class="menu-item active" data-section="dashboard">
                    <i>üìä</i> Dashboard
                </div>
                <div class="menu-item" data-section="classes">
                    <i>üè´</i> Qu·∫£n l√Ω l·ªõp h·ªçc
                </div>
                <div class="menu-item" data-section="exams">
                    <i>üìù</i> T·∫°o b√†i thi
                </div>
                <div class="menu-item" data-section="grading">
                    <i>‚úçÔ∏è</i> Ch·∫•m b√†i thi
                </div>
                <div class="menu-item" data-section="anti-cheating">
                    <i>üîç</i> Gi√°m s√°t gian l·∫≠n
                </div>
                <div class="menu-item" data-section="questions">
                    <i>‚ùì</i> Ng√¢n h√†ng c√¢u h·ªèi
                </div>
                <div class="menu-item" data-section="schedule">
                    <i>üìÖ</i> L·ªãch thi
                </div>
                <div class="menu-item" data-section="statistics">
                    <i>üìà</i> Th·ªëng k√™
                </div>
                <div class="menu-item" data-section="notifications">
                    <i>üì¢</i> Th√¥ng b√°o
                </div>
            </div>
        </div>

        <div class="main-content" id="mainContent">
            <div class="header">
                <div class="header-left" style="display: flex; align-items: center;">
                    <button class="menu-toggle" id="menuToggle">‚ò∞</button>
                    <h1 class="header-title" id="pageTitle">Dashboard</h1>
                </div>
                <div class="header-center" id="welcomeMessage"
                    style="font-size:18px; font-weight:600; color:#555; text-align: center; flex: 1;"></div>
                <div class="header-right" style="display: flex; gap: 15px; align-items: center;">
                    <button id="themeToggle" class="theme-toggle" title="Chuy·ªÉn ƒë·ªïi giao di·ªán">
                        <span class="theme-icon">üåô</span>
                    </button>
                    <div class="notification-badge" onclick="showNotifications()" title="Th√¥ng b√°o">üîî</div>
                    <button id="logoutBtn" class="logout-btn" onclick="logout()" title="ƒêƒÉng xu·∫•t">
                        <span>üö™</span>
                    </button>
                </div>
            </div>

            <!-- DASHBOARD SECTION -->
            <div class="content-section active" id="dashboard">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">üè´</div>
                        <div class="stat-number" id="totalClasses">5</div>
                        <div class="stat-label">L·ªõp h·ªçc</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üë•</div>
                        <div class="stat-number" id="totalStudents">156</div>
                        <div class="stat-label">H·ªçc sinh</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-number" id="totalExams">23</div>
                        <div class="stat-label">B√†i thi</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚≠ê</div>
                        <div class="stat-number" id="avgScore">8.5</div>
                        <div class="stat-label">ƒêi·ªÉm TB</div>
                    </div>
                </div>
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">L·ªõp h·ªçc g·∫ßn ƒë√¢y</h2>
                        <button class="btn btn-primary" onclick="navigateTo('classes')">Xem t·∫•t c·∫£</button>
                    </div>
                    <div class="class-grid" id="dashboardClasses">
                        <!-- Will be populated by JS -->
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Ho·∫°t ƒë·ªông g·∫ßn ƒë√¢y</h2>
                    </div>
                    <div class="notification-list" id="recentActivitiesList">
                        <div style="text-align: center; padding: 40px; color: #718096;">
                            <p>‚è≥ ƒêang t·∫£i ho·∫°t ƒë·ªông...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- CLASSES SECTION -->
            <div class="content-section" id="classes">
                <!-- Class List View -->
                <div id="classList">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">Qu·∫£n l√Ω l·ªõp h·ªçc</h2>
                            <button class="btn btn-primary" onclick="showCreateClass()">‚ûï T·∫°o l·ªõp m·ªõi</button>
                        </div>

                        <div class="search-bar">
                            <input type="text" class="search-input" id="searchClass"
                                placeholder="üîç T√¨m ki·∫øm l·ªõp h·ªçc...">
                            <select id="filterClass"
                                style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                <option value="all">T·∫•t c·∫£ l·ªõp</option>
                                <option value="active">ƒêang ho·∫°t ƒë·ªông</option>
                                <option value="archived">ƒê√£ l∆∞u tr·ªØ</option>
                            </select>
                        </div>
                        <div class="class-grid" id="classGrid">
                            <!-- Classes will be rendered here -->
                        </div>
                    </div>
                </div>

                <!-- Class Detail View -->
                <div id="classDetail" class="class-detail" style="display: none;">
                    <button class="back-btn" onclick="backToClassList()">‚Üê Quay l·∫°i danh s√°ch</button>

                    <div class="card">
                        <div class="card-header">
                            <div>
                                <h2 class="card-title" id="detailClassName">To√°n 10A1</h2>
                                <p style="color: #718096; margin-top: 5px;">M√£ tham gia: <strong
                                        id="detailClassCode">ABC123</strong></p>
                            </div>
                            <div>
                                <button class="btn btn-primary" onclick="showAddExam()">‚ûï Th√™m b√†i thi</button>
                                <button class="btn btn-secondary" onclick="editClass()">‚úèÔ∏è Ch·ªânh s·ª≠a</button>
                            </div>
                        </div>

                        <div class="class-tabs">
                            <button class="tab active" data-tab="students">üë• H·ªçc sinh (<span
                                    id="studentCount">0</span>)</button>
                            <button class="tab" data-tab="exams">üìù B√†i thi (<span id="examCount">0</span>)</button>
                            <button class="tab" data-tab="grades">üìä B·∫£ng ƒëi·ªÉm</button>
                            <button class="tab" data-tab="materials">üìö T√†i li·ªáu</button>
                        </div>

                        <!-- Students Tab -->
                        <div class="tab-content active" id="students-tab">
                            <div
                                style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                                <input type="text" class="search-input" id="searchStudent"
                                    placeholder="üîç T√¨m h·ªçc sinh..." style="flex: 1; min-width: 200px;">
                                <button class="btn btn-success" onclick="showAddStudent()">‚ûï Th√™m h·ªçc sinh</button>
                            </div>
                            <div class="student-list" id="studentList">
                                <!-- Students will be rendered here -->
                            </div>
                        </div>

                        <!-- Exams Tab -->
                        <div class="tab-content" id="exams-tab">
                            <div
                                style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                                <h3 style="color: #2d3748;">Danh s√°ch b√†i thi</h3>
                                <div>
                                    <button class="btn btn-primary" onclick="showAddExam()">‚ûï Th√™m b√†i thi</button>
                                    <label for="importExcelClass" class="btn btn-secondary" style="cursor: pointer;">
                                        üì• Import c√¢u h·ªèi t·ª´ Excel
                                    </label>
                                    <input type="file" id="importExcelClass" accept=".xlsx,.xls,.csv"
                                        style="display: none;" onchange="importExamFromExcel(event)">
                                </div>
                            </div>

                            <!-- Import Result -->
                            <div id="importResultClass"
                                style="margin-bottom: 20px; display: none; background: #f7fafc; padding: 15px; border-radius: 8px;">
                                <h4>K·∫øt qu·∫£ import c√¢u h·ªèi</h4>
                                <p id="importResultMessageClass"></p>
                                <p id="importSuccessCountClass"></p>
                                <p id="importErrorCountClass"></p>
                                <p id="importErrorsClass" style="color: #f56565;"></p>
                            </div>

                            <!-- Exam List Container -->
                            <div id="examListContainer">
                                <div class="exam-list" id="examList">
                                    <!-- Exams will be rendered here -->
                                </div>
                            </div>

                            <!-- Exam Detail (B√äN NGO√ÄI examList) -->
                            <div id="examDetail" style="display: none;">
                                <button class="back-btn" onclick="backToExamList()">‚Üê Quay l·∫°i danh s√°ch</button>
                                <div class="card">
                                    <div class="card-header">
                                        <h2 class="card-title" id="examDetailTitle">Chi ti·∫øt b√†i thi</h2>
                                        <div>
                                            <button class="btn btn-secondary" onclick="showEditExam()">‚úèÔ∏è Ch·ªânh
                                                s·ª≠a</button>
                                        </div>
                                    </div>
                                    <div id="examDetailContentClass" style="padding: 20px;">
                                        <!-- Th√¥ng tin c∆° b·∫£n -->
                                        <div
                                            style="background: #f5f5f5; padding: 20px; border-radius: 8px; margin-bottom: 25px; border: 1px solid #e8e8e8;">
                                            <div
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üè´
                                                        L·ªõp h·ªçc</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748;"
                                                        id="examDetailClass">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üìÖ
                                                        Ng√†y thi</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748;"
                                                        id="examDetailDate">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">‚è±Ô∏è
                                                        Th·ªùi l∆∞·ª£ng</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748;"
                                                        id="examDetailDuration">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üîê
                                                        M√£ code</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748; font-family: 'Courier New', monospace; letter-spacing: 2px;"
                                                        id="examDetailCode">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üìä
                                                        Tr·∫°ng th√°i</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600;"
                                                        id="examDetailStatus">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üìù
                                                        S·ªë c√¢u h·ªèi</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748;"
                                                        id="examDetailQuestionCount">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">‚≠ê
                                                        T·ªïng ƒëi·ªÉm</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #48bb78;"
                                                        id="examDetailTotalPoints">-</p>
                                                </div>
                                                <div>
                                                    <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üë•
                                                        S·ªë b√†i n·ªôp</p>
                                                    <p style="font-size: 1.1rem; font-weight: 600; color: #2d3748;"
                                                        id="examDetailSubmissions">-</p>
                                                </div>
                                            </div>
                                            <div
                                                style="margin-top: 15px; padding-top: 15px; border-top: 1px solid #e2e8f0;">
                                                <p style="color: #718096; font-size: 0.9rem; margin-bottom: 5px;">üìÑ M√¥
                                                    t·∫£</p>
                                                <p style="font-size: 1rem; color: #2d3748;" id="examDetailDescription">-
                                                </p>
                                            </div>
                                        </div>

                                        <!-- Tabs cho Exam Detail -->
                                        <div class="class-tabs" style="margin-bottom: 20px;">
                                            <button class="tab active" data-tab="exam-questions"
                                                onclick="switchExamDetailTab('questions')">
                                                üìã C√¢u h·ªèi
                                            </button>
                                            <button class="tab" data-tab="exam-students-status"
                                                onclick="switchExamDetailTab('students-status')">
                                                üë• Tr·∫°ng th√°i n·ªôp b√†i
                                            </button>
                                        </div>

                                        <!-- Tab: Danh s√°ch c√¢u h·ªèi -->
                                        <div id="examQuestionsTab" class="exam-detail-tab-content active">
                                            <h3 style="color: #2d3748; margin-bottom: 15px; font-size: 1.3rem;">üìã Danh
                                                s√°ch c√¢u h·ªèi</h3>
                                            <div id="examDetailQuestions" class="question-list"></div>
                                        </div>

                                        <!-- Tab: Tr·∫°ng th√°i n·ªôp b√†i -->
                                        <div id="examStudentsStatusTab" class="exam-detail-tab-content"
                                            style="display: none;">
                                            <div
                                                style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
                                                <h3 style="color: #2d3748; font-size: 1.3rem; margin: 0;">üë• Tr·∫°ng th√°i
                                                    n·ªôp b√†i c·ªßa h·ªçc sinh</h3>
                                                <button class="btn btn-secondary" onclick="refreshStudentsStatus()"
                                                    style="padding: 8px 16px;">
                                                    üîÑ L√†m m·ªõi
                                                </button>
                                            </div>

                                            <!-- Th·ªëng k√™ t·ªïng quan -->
                                            <div id="examStatusStats"
                                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin-bottom: 25px;">
                                                <!-- Stats s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                                            </div>

                                            <!-- B·ªô l·ªçc v√† t√¨m ki·∫øm -->
                                            <div
                                                style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                                                <input type="text" id="searchStudentStatus" class="search-input"
                                                    placeholder="üîç T√¨m h·ªçc sinh..." style="flex: 1; min-width: 200px;"
                                                    oninput="filterStudentStatus()">
                                                <select id="filterStudentStatus" class="search-input"
                                                    style="width: 200px;" onchange="filterStudentStatus()">
                                                    <option value="all">T·∫•t c·∫£</option>
                                                    <option value="not_started">Ch∆∞a b·∫Øt ƒë·∫ßu</option>
                                                    <option value="InProgress">ƒêang l√†m b√†i</option>
                                                    <option value="Submitted">ƒê√£ n·ªôp b√†i</option>
                                                    <option value="AutoSubmitted">T·ª± ƒë·ªông n·ªôp</option>
                                                    <option value="banned">B·ªã c·∫•m thi</option>
                                                </select>
                                            </div>

                                            <!-- Danh s√°ch h·ªçc sinh -->
                                            <div id="examStudentsStatusList" style="display: grid; gap: 15px;">
                                                <!-- Danh s√°ch s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Edit Exam Form (B√äN NGO√ÄI examList) -->
                            <div id="editExamForm" style="display: none;">
                                <button class="back-btn" onclick="hideEditExam()">‚Üê Quay l·∫°i</button>
                                <div class="card">
                                    <h2 class="card-title" style="margin-bottom: 20px;">Ch·ªânh s·ª≠a b√†i thi</h2>
                                    <form id="editExamFormContent" onsubmit="handleEditExam(event)">
                                        <input type="hidden" name="examId">
                                        <div class="form-group">
                                            <label>T√™n b√†i thi <span style="color: #f56565;">*</span></label>
                                            <input type="text" name="examName" required
                                                placeholder="VD: Ki·ªÉm tra 15 ph√∫t - Ch∆∞∆°ng 1">
                                        </div>
                                        <div class="form-group">
                                            <label>Ng√†y thi <span style="color: #f56565;">*</span></label>
                                            <input type="date" name="examDate" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Gi·ªù b·∫Øt ƒë·∫ßu <span style="color: #f56565;">*</span></label>
                                            <input type="time" name="examTime" required>
                                        </div>
                                        <div class="form-group">
                                            <label>Th·ªùi gian l√†m b√†i (ph√∫t) <span
                                                    style="color: #f56565;">*</span></label>
                                            <input type="number" name="duration" required min="1" placeholder="VD: 45">
                                        </div>
                                        <div class="form-group">
                                            <label>M√¥ t·∫£</label>
                                            <textarea name="description" rows="3"
                                                placeholder="M√¥ t·∫£ v·ªÅ b√†i thi..."></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label>Tr·∫°ng th√°i</label>
                                            <select name="status">
                                                <option value="draft">Nh√°p</option>
                                                <option value="upcoming">S·∫Øp di·ªÖn ra</option>
                                                <option value="active">ƒêang di·ªÖn ra</option>
                                                <option value="completed">ƒê√£ k·∫øt th√∫c</option>
                                            </select>
                                        </div>
                                        <div style="margin-top: 20px;">
                                            <button type="submit" class="btn btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
                                            <button type="button" class="btn btn-secondary"
                                                onclick="hideEditExam()">H·ªßy</button>
                                        </div>
                                    </form>
                                    <h3 style="color: #2d3748; margin: 20px 0;">Danh s√°ch c√¢u h·ªèi</h3>
                                    <div id="editExamQuestions" class="question-list"></div>
                                </div>
                            </div>
                        </div>

                        <!-- Grades Tab -->
                        <div class="tab-content" id="grades-tab">
                            <h3 style="color: #2d3748; margin-bottom: 20px;">B·∫£ng ƒëi·ªÉm t·ªïng h·ª£p</h3>
                            <div class="card" style="background: white;">
                                <table style="width: 100%; border-collapse: collapse;">
                                    <thead>
                                        <tr style="border-bottom: 2px solid #e2e8f0;">
                                            <th style="padding: 12px; text-align: left;">H·ªçc sinh</th>
                                            <th style="padding: 12px; text-align: center;">S·ªë b√†i ƒë√£ l√†m</th>
                                            <th style="padding: 12px; text-align: center;">ƒêi·ªÉm TB</th>
                                        </tr>
                                    </thead>
                                    <tbody id="gradesTable">
                                        <!-- Grades will be rendered here -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- Materials Tab -->
                        <div class="tab-content" id="materials-tab">
                            <div
                                style="display: flex; justify-content: space-between; margin-bottom: 20px; flex-wrap: wrap; gap: 10px;">
                                <h3 style="color: #2d3748;">T√†i li·ªáu h·ªçc t·∫≠p</h3>
                                <button class="btn btn-primary" onclick="showUploadMaterialForm()">üì§ Upload t√†i
                                    li·ªáu</button>
                            </div>
                            <div id="materialsList">
                                <!-- Materials will be rendered here -->
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Create Class Form -->
                <div id="createClassForm" style="display: none;">
                    <button class="back-btn" onclick="hideCreateClass()">‚Üê Quay l·∫°i</button>

                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">T·∫°o l·ªõp h·ªçc m·ªõi</h2>
                        <form onsubmit="handleCreateClass(event)">
                            <div class="form-group">
                                <label>T√™n l·ªõp h·ªçc <span style="color: #f56565;">*</span></label>
                                <input type="text" name="className" required
                                    placeholder="VD: To√°n 10A1, L·∫≠p tr√¨nh Python...">
                            </div>
                            <div class="form-group">
                                <label>M√¥n h·ªçc <span style="color: #f56565;">*</span></label>
                                <input type="text" name="subject" required placeholder="VD: To√°n h·ªçc, Tin h·ªçc...">
                            </div>
                            <div class="form-group">
                                <label>M√¥ t·∫£</label>
                                <textarea name="description" rows="4"
                                    placeholder="M√¥ t·∫£ v·ªÅ l·ªõp h·ªçc, m·ª•c ti√™u, y√™u c·∫ßu..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>NƒÉm h·ªçc</label>
                                <input type="text" name="academicYear" placeholder="VD: 2024-2025" value="2024-2025">
                            </div>
                            <div class="form-group">
                                <label>Icon l·ªõp h·ªçc</label>
                                <select name="icon">
                                    <option value="üìö">üìö S√°ch</option>
                                    <option value="üìñ">üìñ VƒÉn h·ªçc</option>
                                    <option value="üìê">üìê To√°n h·ªçc</option>
                                    <option value="üß™">üß™ H√≥a h·ªçc</option>
                                    <option value="‚öõÔ∏è">‚öõÔ∏è V·∫≠t l√Ω</option>
                                    <option value="üåç">üåç ƒê·ªãa l√Ω</option>
                                    <option value="üé®">üé® M·ªπ thu·∫≠t</option>
                                    <option value="üéµ">üéµ √Çm nh·∫°c</option>
                                    <option value="üíª">üíª Tin h·ªçc</option>
                                    <option value="üá¨üáß">üá¨üáß Ti·∫øng Anh</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;">
                                <button type="submit" class="btn btn-primary">‚ú® T·∫°o l·ªõp</button>
                                <button type="button" class="btn btn-secondary" onclick="hideCreateClass()">H·ªßy</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Edit Class Form -->
                <div id="editClassForm" style="display: none;">
                    <button class="back-btn" onclick="hideEditClass()">‚Üê Quay l·∫°i</button>

                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">Ch·ªânh s·ª≠a l·ªõp h·ªçc</h2>
                        <form id="editClassFormElement" onsubmit="handleEditClass(event)">
                            <div class="form-group">
                                <label>T√™n l·ªõp h·ªçc <span style="color: #f56565;">*</span></label>
                                <input type="text" name="className" id="editClassName" required
                                    placeholder="VD: To√°n 10A1, L·∫≠p tr√¨nh Python...">
                            </div>
                            <div class="form-group">
                                <label>M√¥n h·ªçc <span style="color: #f56565;">*</span></label>
                                <input type="text" name="subject" id="editSubject" required
                                    placeholder="VD: To√°n h·ªçc, Tin h·ªçc...">
                            </div>
                            <div class="form-group">
                                <label>M√¥ t·∫£</label>
                                <textarea name="description" id="editDescription" rows="4"
                                    placeholder="M√¥ t·∫£ v·ªÅ l·ªõp h·ªçc, m·ª•c ti√™u, y√™u c·∫ßu..."></textarea>
                            </div>
                            <div class="form-group">
                                <label>NƒÉm h·ªçc</label>
                                <input type="text" name="academicYear" id="editAcademicYear" placeholder="VD: 2024-2025"
                                    value="2024-2025">
                            </div>
                            <div class="form-group">
                                <label>Icon l·ªõp h·ªçc</label>
                                <select name="icon" id="editIcon">
                                    <option value="üìö">üìö S√°ch</option>
                                    <option value="üìñ">üìñ VƒÉn h·ªçc</option>
                                    <option value="üìê">üìê To√°n h·ªçc</option>
                                    <option value="üß™">üß™ H√≥a h·ªçc</option>
                                    <option value="‚öõÔ∏è">‚öõÔ∏è V·∫≠t l√Ω</option>
                                    <option value="üåç">üåç ƒê·ªãa l√Ω</option>
                                    <option value="üé®">üé® M·ªπ thu·∫≠t</option>
                                    <option value="üéµ">üéµ √Çm nh·∫°c</option>
                                    <option value="üíª">üíª Tin h·ªçc</option>
                                    <option value="üá¨üáß">üá¨üáß Ti·∫øng Anh</option>
                                </select>
                            </div>
                            <div style="margin-top: 20px;">
                                <button type="submit" class="btn btn-primary">üíæ L∆∞u thay ƒë·ªïi</button>
                                <button type="button" class="btn btn-secondary" onclick="hideEditClass()">H·ªßy</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add Student Form -->
                <div id="addStudentForm" style="display: none;">
                    <button class="back-btn" onclick="hideAddStudent()">‚Üê Quay l·∫°i</button>

                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">Th√™m h·ªçc sinh v√†o l·ªõp</h2>
                        <form onsubmit="handleAddStudent(event)">
                            <div class="form-group">
                                <label>T√™n h·ªçc sinh <span style="color: #f56565;">*</span></label>
                                <input type="text" name="studentName" required placeholder="VD: Nguy·ªÖn VƒÉn A">
                            </div>
                            <div class="form-group">
                                <label>M√£ s·ªë h·ªçc sinh <span style="color: #f56565;">*</span></label>
                                <input type="text" name="studentId" required placeholder="VD: SV001">
                            </div>
                            <div class="form-group">
                                <label>Email</label>
                                <input type="email" name="email" placeholder="student@email.com">
                            </div>
                            <div style="margin-top: 20px;">
                                <button type="submit" class="btn btn-success">‚ûï Th√™m h·ªçc sinh</button>
                                <button type="button" class="btn btn-secondary" onclick="hideAddStudent()">H·ªßy</button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Add Exam Form -->
                <div id="addExamForm" style="display: none;">
                    <button class="back-btn" onclick="hideAddExam()">‚Üê Quay l·∫°i</button>

                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">Th√™m b√†i thi v√†o l·ªõp</h2>
                        <form onsubmit="handleAddExam(event)">
                            <div class="form-group">
                                <label>T√™n b√†i thi <span style="color: #f56565;">*</span></label>
                                <input type="text" name="examName" required
                                    placeholder="VD: Ki·ªÉm tra 15 ph√∫t - Ch∆∞∆°ng 1">
                            </div>

                            <div class="form-group">
                                <label>Ng√†y thi <span style="color: #f56565;">*</span></label>
                                <input type="date" name="examDate" required>
                            </div>

                            <div class="form-group">
                                <label>Gi·ªù b·∫Øt ƒë·∫ßu <span style="color: #f56565;">*</span></label>
                                <input type="time" name="examTime" required value="08:00">
                                <small style="color: #718096; display: block; margin-top: 5px;">
                                    VD: 08:00 (8 gi·ªù s√°ng), 14:30 (2 gi·ªù 30 chi·ªÅu)
                                </small>
                            </div>

                            <div class="form-group">
                                <label>Th·ªùi gian l√†m b√†i (ph√∫t) <span style="color: #f56565;">*</span></label>
                                <input type="number" name="duration" required min="1" placeholder="VD: 45">
                            </div>

                            <div class="form-group">
                                <label>M√¥ t·∫£</label>
                                <textarea name="description" rows="3" placeholder="M√¥ t·∫£ v·ªÅ b√†i thi..."></textarea>
                            </div>

                            <div class="form-group">
                                <label style="font-weight: 600; margin-bottom: 12px; display: block; color: #2d3748;">üîÄ
                                    X√°o tr·ªôn</label>
                                <div class="shuffle-options">
                                    <label class="shuffle-checkbox-label">
                                        <input type="checkbox" name="shuffleQuestions" value="1"
                                            class="shuffle-checkbox">
                                        <span>X√°o tr·ªôn th·ª© t·ª± c√¢u h·ªèi</span>
                                    </label>
                                    <label class="shuffle-checkbox-label">
                                        <input type="checkbox" name="shuffleOptions" value="1" class="shuffle-checkbox">
                                        <span>X√°o tr·ªôn th·ª© t·ª± ƒë√°p √°n</span>
                                    </label>
                                </div>
                                <small
                                    style="color: #718096; display: block; margin-top: 10px; font-size: 0.85rem; line-height: 1.4;">
                                    M·ªói h·ªçc sinh s·∫Ω nh·∫≠n th·ª© t·ª± c√¢u h·ªèi/ƒë√°p √°n kh√°c nhau ƒë·ªÉ tr√°nh gian l·∫≠n
                                </small>
                            </div>

                            <div class="form-group"
                                style="margin-top: 25px; padding-top: 25px; border-top: 2px solid #e2e8f0;">
                                <label style="font-weight: 600; margin-bottom: 12px; display: block; color: #2d3748;">üì•
                                    Import ƒë·ªÅ thi c√≥ s·∫µn (T√πy ch·ªçn)</label>
                                <select id="importExamSelect" name="importExamId" class="form-control"
                                    style="margin-bottom: 10px;">
                                    <option value="">-- Ch·ªçn ƒë·ªÅ thi ƒë·ªÉ import c√¢u h·ªèi --</option>
                                </select>
                                <small
                                    style="color: #718096; display: block; margin-top: 5px; font-size: 0.85rem; line-height: 1.4;">
                                    Ch·ªçn m·ªôt ƒë·ªÅ thi c√≥ s·∫µn ƒë·ªÉ t·ª± ƒë·ªông import t·∫•t c·∫£ c√¢u h·ªèi v√†o b√†i thi m·ªõi n√†y
                                </small>
                                <div id="importExamInfo"
                                    style="display: none; margin-top: 10px; padding: 10px; background: #edf2f7; border-radius: 6px; font-size: 0.9rem;">
                                    <span id="importExamInfoText"></span>
                                </div>
                            </div>

                            <div class="form-group"
                                style="margin-top: 25px; padding-top: 25px; border-top: 2px solid #e2e8f0;">
                                <label style="font-weight: 600; margin-bottom: 12px; display: block; color: #2d3748;">üìù
                                    Import c√¢u h·ªèi (T√πy ch·ªçn)</label>

                                <!-- Import t·ª´ Excel/CSV -->
                                <div style="margin-bottom: 15px;">
                                    <label
                                        style="font-size: 0.9rem; color: #4a5568; display: block; margin-bottom: 8px;">
                                        üì• Import t·ª´ Excel/CSV
                                    </label>
                                    <input type="file" id="importQuestionsFileAddExam" accept=".xlsx,.xls,.csv"
                                        class="form-control" style="margin-bottom: 5px;">
                                    <small
                                        style="color: #718096; display: block; margin-top: 5px; font-size: 0.85rem; line-height: 1.4;">
                                        T·∫£i l√™n file Excel/CSV ch·ª©a danh s√°ch c√¢u h·ªèi cho b√†i thi n√†y
                                    </small>
                                    <a href="/sample_questions.xlsx" download class="btn btn-sm btn-outline-secondary"
                                        style="margin-top: 8px; font-size: 0.85rem; display: inline-block; padding: 6px 12px; border: 1px solid #cbd5e0; border-radius: 4px; text-decoration: none; color: #4a5568;">
                                        üìÑ T·∫£i file m·∫´u
                                    </a>
                                </div>
                            </div>

                            <div style="margin-top: 20px;">
                                <button type="submit" class="btn btn-primary">‚ûï Th√™m b√†i thi</button>
                                <button type="button" class="btn btn-secondary" onclick="hideAddExam()">H·ªßy</button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>

            <!-- EXAMS SECTION -->
            <div class="content-section" id="exams">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">T·∫°o b√†i thi m·ªõi</h2>
                    </div>
                    <div class="exam-creation-grid">
                        <div class="card" style="cursor: pointer; text-align: center; transition: all 0.3s ease;"
                            onclick="openAIModal()">
                            <div style="font-size: 3rem; margin-bottom: 15px;">ü§ñ</div>
                            <h3 style="margin-bottom: 10px;">T·∫°o v·ªõi AI</h3>
                            <p style="color: #718096;">T·ª± ƒë·ªông t·∫°o ƒë·ªÅ thi t·ª´ ch·ªß ƒë·ªÅ v√† y√™u c·∫ßu</p>
                        </div>
                        <div class="card" style="cursor: pointer; text-align: center; transition: all 0.3s ease;"
                            onclick="showNotification('T√≠nh nƒÉng t·∫°o ƒë·ªÅ th·ªß c√¥ng ƒëang ƒë∆∞·ª£c ph√°t tri·ªÉn', 'info')">
                            <div style="font-size: 3rem; margin-bottom: 15px;">‚úèÔ∏è</div>
                            <h3 style="margin-bottom: 10px;">T·∫°o th·ªß c√¥ng</h3>
                            <p style="color: #718096;">T·ª± so·∫°n c√¢u h·ªèi v√† ƒë·ªÅ thi theo √Ω mu·ªën</p>
                        </div>
                        <div class="card" style="cursor: pointer; text-align: center; transition: all 0.3s ease;">
                            <div style="font-size: 3rem; margin-bottom: 15px;">üì•</div>
                            <h3 style="margin-bottom: 10px;">Import t·ª´ Excel</h3>
                            <p style="color: #718096;">T·∫£i l√™n file Excel ƒë·ªÉ th√™m c√¢u h·ªèi</p>
                            <label for="importExcelSection" class="btn btn-primary" style="margin-top: 10px;">Ch·ªçn file
                                Excel</label>
                            <input type="file" id="importExcelSection" accept=".xlsx,.xls,.csv" style="display: none;"
                                onchange="importExamFromExcel(event)">
                        </div>
                    </div>

                    <!-- Import Result Section -->
                    <div id="importResultSection"
                        style="margin-top: 20px; display: none; background: #f7fafc; padding: 15px; border-radius: 8px;">
                        <h4>K·∫øt qu·∫£ import c√¢u h·ªèi</h4>
                        <p id="importResultMessageSection"></p>
                        <p id="importSuccessCountSection"></p>
                        <p id="importErrorCountSection"></p>
                        <p id="importErrorsSection" style="color: #f56565;"></p>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">B√†i thi ƒë√£ t·∫°o</h2>
                        <input type="text" class="search-input" placeholder="üîç T√¨m b√†i thi..."
                            style="max-width: 300px;">
                    </div>
                    <div class="exam-list" id="allExamsList">
                        <!-- All exams will be rendered here -->
                    </div>
                </div>
            </div>

            <!-- GRADING SECTION -->
            <div class="content-section" id="grading">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">‚è≥</div>
                        <div class="stat-number" id="gradingPendingCount">0</div>
                        <div class="stat-label">B√†i ch·ªù ch·∫•m</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úÖ</div>
                        <div class="stat-number" id="gradingGradedCount">0</div>
                        <div class="stat-label">B√†i ƒë√£ ch·∫•m</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">üìù</div>
                        <div class="stat-number" id="gradingEssayCount">0</div>
                        <div class="stat-label">C√¢u t·ª± lu·∫≠n</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">‚úçÔ∏è</div>
                        <div class="stat-number" id="gradingFillCount">0</div>
                        <div class="stat-label">C√¢u ƒëi·ªÅn kh·∫©u</div>
                    </div>
                </div>

                <!-- Tabs ƒë·ªÉ chuy·ªÉn gi·ªØa "C·∫ßn ch·∫•m" v√† "L·ªãch s·ª≠" -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="class-tabs" style="border-bottom: 2px solid #e2e8f0; margin-bottom: 0;">
                        <button class="tab active" data-tab="pending-grading" onclick="switchGradingTab('pending')">
                            ‚è≥ C·∫ßn ch·∫•m
                        </button>
                        <button class="tab" data-tab="graded-history" onclick="switchGradingTab('graded')">
                            ‚úÖ L·ªãch s·ª≠ ƒë√£ ch·∫•m
                        </button>
                    </div>
                </div>

                <!-- Tab: C·∫ßn ch·∫•m (theo l·ªõp h·ªçc) -->
                <div id="pendingGradingTab" class="grading-tab-content active">
                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">üìã Danh s√°ch b√†i c·∫ßn ch·∫•m (theo l·ªõp h·ªçc)
                        </h2>
                        <div id="gradingClassList" class="class-grid">
                            <!-- Danh s√°ch l·ªõp h·ªçc s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                        </div>
                    </div>
                </div>

                <!-- Tab: L·ªãch s·ª≠ ƒë√£ ch·∫•m -->
                <div id="gradedHistoryTab" class="grading-tab-content" style="display: none;">
                    <div class="card">
                        <h2 class="card-title" style="margin-bottom: 20px;">üìú L·ªãch s·ª≠ b√†i ƒë√£ ch·∫•m</h2>
                        <div id="gradedHistoryList" class="exam-list">
                            <!-- L·ªãch s·ª≠ b√†i ƒë√£ ch·∫•m s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                        </div>
                    </div>
                </div>
            </div>
            <!-- GRADING MODAL -->
            <div id="gradingModal" class="modal" style="display: none;">
                <div class="modal-content" style="max-width: 900px; max-height: 90vh; overflow-y: auto;">
                    <div class="modal-header">
                        <h3 id="gradingModalTitle">‚úçÔ∏è Ch·∫•m b√†i</h3>
                        <span class="close" onclick="closeGradingModal()">&times;</span>
                    </div>

                    <div id="gradingModalInfo"
                        style="background: #f7fafc; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                        <!-- Th√¥ng tin h·ªçc sinh v√† b√†i thi -->
                    </div>

                    <!-- Th√¥ng tin vi ph·∫°m gian l·∫≠n -->
                    <div id="gradingViolationInfo"
                        style="background: #fff5f5; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 4px solid #dc3545; display: none; border: 1px solid #e8e8e8;">
                        <h4 style="color: #c53030; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                            ‚ö†Ô∏è Th√¥ng tin vi ph·∫°m gian l·∫≠n
                        </h4>
                        <div id="violationDetails"
                            style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 10px; color: #742a2a;">
                            <!-- Chi ti·∫øt vi ph·∫°m s·∫Ω ƒë∆∞·ª£c render ·ªü ƒë√¢y -->
                        </div>
                    </div>

                    <form id="gradingForm">
                        <div id="gradingQuestionsList" style="padding-bottom: 200px;">
                            <!-- Danh s√°ch c√¢u h·ªèi c·∫ßn ch·∫•m -->
                        </div>

                        <!-- Spacer ƒë·ªÉ ƒë·∫£m b·∫£o n·ªôi dung kh√¥ng b·ªã che -->
                        <div style="height: 50px;"></div>

                        <div
                            style="margin-top: 30px; display: flex; gap: 15px; justify-content: flex-end; background: white; padding: 15px 20px; border-top: 1px solid #e2e8f0;">
                            <button type="button" class="btn btn-secondary" onclick="closeGradingModal()">H·ªßy</button>
                            <button type="submit" class="btn btn-success">üíæ L∆∞u ƒëi·ªÉm</button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="content-section" id="anti-cheating">
                <div class="card" style="margin-bottom: 20px;">
                    <div class="card-header"
                        style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:15px;">
                        <h2 class="card-title" style="margin:0;font-size:1.5rem;color:#2d3748;">üîç Gi√°m s√°t gian l·∫≠n
                        </h2>
                        <div class="cheating-filters" style="display:flex;gap:10px;flex-wrap:wrap;align-items:center;">
                            <select id="filterExamCheating" onchange="loadCheatingLogs()"
                                style="padding:10px 15px;border:1px solid #e2e8f0;border-radius:6px;font-size:0.95rem;">
                                <option value="all">T·∫•t c·∫£ b√†i thi</option>
                            </select>
                            <select id="filterEventType" onchange="loadCheatingLogs()"
                                style="padding:10px 15px;border:1px solid #e2e8f0;border-radius:6px;font-size:0.95rem;">
                                <option value="all">T·∫•t c·∫£ lo·∫°i</option>
                                <option value="TabSwitch">üö´ Chuy·ªÉn tab</option>
                                <option value="CopyPaste">üìã Copy/Paste</option>
                                <option value="WebcamSuspicious">üì∑ L·ªói webcam</option>
                                <option value="DevTools">üîß M·ªü DevTools</option>
                            </select>
                            <button class="btn btn-secondary" onclick="loadCheatingLogs()">üîÑ L√†m m·ªõi</button>
                            <button class="btn btn-secondary" onclick="exportCheatingReport()">üì• Xu·∫•t b√°o c√°o</button>
                        </div>
                    </div>
                </div>

                <!-- Stats Grid -->
                <div class="cheating-stats-grid">
                    <div class="cheating-stats-card"
                        style="background:#4a5568;color:white;padding:15px;text-align:center;border-radius:8px;">
                        <div style="font-size:1.5rem;">‚ö†Ô∏è</div>
                        <div id="totalCheatingEvents" style="font-size:1.8rem;font-weight:bold;">0</div>
                        <div style="font-size:0.85rem;opacity:0.9;">T·ªïng vi ph·∫°m</div>
                    </div>
                    <div class="cheating-stats-card"
                        style="background:#dc3545;color:white;padding:15px;text-align:center;border-radius:8px;">
                        <div style="font-size:1.5rem;">üö´</div>
                        <div id="totalTabSwitches" style="font-size:1.8rem;font-weight:bold;">0</div>
                        <div style="font-size:0.85rem;opacity:0.9;">Chuy·ªÉn tab</div>
                    </div>
                    <div class="cheating-stats-card"
                        style="background:#ffc107;color:#212529;padding:15px;text-align:center;border-radius:8px;">
                        <div style="font-size:1.5rem;">üìã</div>
                        <div id="totalCopyPaste" style="font-size:1.8rem;font-weight:bold;">0</div>
                        <div style="font-size:0.85rem;opacity:0.9;">Copy/Paste</div>
                    </div>
                    <div class="cheating-stats-card"
                        style="background:#17a2b8;color:white;padding:15px;text-align:center;border-radius:8px;">
                        <div style="font-size:1.5rem;">üë§</div>
                        <div id="suspiciousStudents" style="font-size:1.8rem;font-weight:bold;">0</div>
                        <div style="font-size:0.85rem;opacity:0.9;">H·ªçc sinh vi ph·∫°m</div>
                    </div>
                </div>

                <!-- List View -->
                <div class="card" id="cheatingListCard">
                    <div class="card-header">
                        <h2 class="card-title" style="font-size:1.3rem;color:#2d3748;">üìã Danh s√°ch h·ªçc sinh nghi ng·ªù
                        </h2>
                    </div>
                    <div class="search-bar" style="margin-bottom:15px;">
                        <input type="text" class="search-input" id="searchCheating" oninput="filterCheatingLogs()"
                            placeholder="üîç T√¨m h·ªçc sinh ho·∫∑c b√†i thi..."
                            style="width:100%;padding:10px;border-radius:6px;">
                    </div>
                    <div style="overflow-x:auto;">
                        <table class="cheating-table" style="width:100%;border-collapse:collapse;">
                            <thead>
                                <tr style="border-bottom:2px solid #e2e8f0;background:#f7fafc;">
                                    <th style="padding:12px;text-align:left;">H·ªçc sinh</th>
                                    <th style="padding:12px;text-align:left;">B√†i thi</th>
                                    <th style="padding:12px;text-align:center;">Vi ph·∫°m</th>
                                    <th style="padding:12px;text-align:center;">M·ª©c ƒë·ªô</th>
                                    <th style="padding:12px;text-align:right;">H√†nh ƒë·ªông</th>
                                </tr>
                            </thead>
                            <tbody id="cheatingLogsList">
                                <tr>
                                    <td colspan="5" style="text-align:center;padding:40px;color:#718096;">‚è≥ ƒêang t·∫£i d·ªØ
                                        li·ªáu...</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>

                <!-- Detail View -->
                <div class="card" id="studentCheatingDetail" style="display:none;">
                    <button class="back-btn" onclick="backToCheatingList()">‚Üê Quay l·∫°i danh s√°ch</button>
                    <div style="background:#dc3545;color:white;border-radius:8px;padding:20px;margin-bottom:20px;">
                        <h2 id="studentCheatingName" style="margin-bottom:10px;">Chi ti·∫øt gian l·∫≠n</h2>
                        <p><strong>B√†i thi:</strong> <span id="detailExamName">-</span> | <strong>‚è∞</strong> <span
                                id="detailExamTime">-</span></p>
                        <p><strong>‚ö†Ô∏è</strong> <span id="detailTotalViolations">0</span> vi ph·∫°m</p>
                        <button class="btn btn-danger" onclick="banStudent()"
                            style="background:white;color:#c53030;font-weight:600;">üö´ C·∫•m thi</button>
                    </div>
                    <h3>üìú L·ªãch s·ª≠ vi ph·∫°m</h3>
                    <div id="cheatingTimeline"
                        style="max-height:400px;overflow-y:auto;border:1px solid #e2e8f0;border-radius:6px;padding:10px;">
                        <!-- timeline -->
                    </div>
                </div>
            </div>
            <!-- QUESTIONS SECTION -->
            <div class="content-section" id="questions">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Ng√¢n h√†ng c√¢u h·ªèi</h2>
                        <div>
                            <button class="btn btn-primary"
                                onclick="showNotification('T√≠nh nƒÉng th√™m c√¢u h·ªèi ƒëang ph√°t tri·ªÉn', 'info')">‚ûï Th√™m c√¢u
                                h·ªèi</button>
                            <button class="btn btn-secondary"
                                onclick="showNotification('T√≠nh nƒÉng import ƒëang ph√°t tri·ªÉn', 'info')">üì• Import
                                Excel</button>
                            <button class="btn btn-warning" onclick="removeDuplicateQuestions()"
                                style="background: #f59e0b; color: white;">üóëÔ∏è X√≥a c√¢u h·ªèi tr√πng</button>
                        </div>
                    </div>

                    <div class="search-bar">
                        <input type="text" class="search-input" placeholder="üîç T√¨m ki·∫øm c√¢u h·ªèi..."
                            id="questionSearchInput">
                        <select style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;"
                            id="questionSubjectSelect">
                            <option value="all">T·∫•t c·∫£ m√¥n</option>
                            <!-- Danh s√°ch m√¥n s·∫Ω ƒë∆∞·ª£c load ƒë·ªông -->
                        </select>
                        <select style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;"
                            id="questionDifficultySelect">
                            <option value="all">T·∫•t c·∫£ ƒë·ªô kh√≥</option>
                            <option value="Easy">D·ªÖ</option>
                            <option value="Medium">Trung b√¨nh</option>
                            <option value="Hard">Kh√≥</option>
                        </select>
                    </div>

                    <div class="question-grid" id="questionList">
                        <div style="text-align: center; padding: 40px;">
                            <p>‚è≥ ƒêang t·∫£i c√¢u h·ªèi...</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- l·ªãch thi -->
            <div class="content-section" id="schedule">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">L·ªãch thi</h2>
                        <button class="btn btn-primary" onclick="showCreateExamModal()">‚ûï T·∫°o b√†i thi</button>
                    </div>

                    <div style="margin-top: 20px;">
                        <div style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap;">
                            <button class="btn btn-small btn-primary" onclick="loadExamSchedule('all')"
                                id="scheduleFilterAll">T·∫•t c·∫£</button>
                            <button class="btn btn-small btn-secondary" onclick="loadExamSchedule('upcoming')"
                                id="scheduleFilterUpcoming">S·∫Øp t·ªõi</button>
                            <button class="btn btn-small btn-secondary" onclick="loadExamSchedule('active')"
                                id="scheduleFilterActive">ƒêang di·ªÖn ra</button>
                            <button class="btn btn-small btn-secondary" onclick="loadExamSchedule('completed')"
                                id="scheduleFilterCompleted">ƒê√£ k·∫øt th√∫c</button>
                        </div>

                        <h3 style="color: #2d3748; margin-bottom: 15px;" id="scheduleTitle">L·ªãch thi s·∫Øp t·ªõi</h3>
                        <div class="exam-list" id="examScheduleList">
                            <div style="text-align: center; padding: 40px;">
                                <p>‚è≥ ƒêang t·∫£i l·ªãch thi...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- th·ªëng k√™-->
            <div class="content-section" id="statistics">
                <div class="card">
                    <div class="card-header">
                        <h2 class="card-title">Th·ªëng k√™ k·∫øt qu·∫£ h·ªçc t·∫≠p</h2>
                        <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                            <select id="statsClass" onchange="updateStatistics()">
                                <option value="all">T·∫•t c·∫£ l·ªõp</option>
                            </select>
                            <select id="chartType" onchange="updateChartType()">
                                <option value="bar">Bi·ªÉu ƒë·ªì c·ªôt</option>
                                <option value="pie">Bi·ªÉu ƒë·ªì tr√≤n</option>
                                <option value="line">Bi·ªÉu ƒë·ªì ƒë∆∞·ªùng</option>
                            </select>
                        </div>
                    </div>
                    <div style="height: 400px; margin-top: 20px;">
                        <canvas id="statisticsChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2 class="card-title" style="margin-bottom: 20px;">üìä B√°o c√°o chi ti·∫øt</h2>

                    <!-- Th·ªëng k√™ ƒëi·ªÉm s·ªë -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìà Th·ªëng k√™ ƒëi·ªÉm s·ªë</h3>
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-label">T·ª∑ l·ªá ƒë·∫°t</div>
                            <div class="stat-number" id="statPassRate" style="font-size: 2rem; color: #48bb78;">0%</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">(‚â• 5 ƒëi·ªÉm)</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ƒêi·ªÉm trung b√¨nh</div>
                            <div class="stat-number" id="statAvgScore" style="font-size: 2rem; color: #2d3748;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">T·∫•t c·∫£ b√†i thi</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ƒêi·ªÉm cao nh·∫•t</div>
                            <div class="stat-number" id="statMaxScore" style="font-size: 2rem; color: #48bb78;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">ƒêi·ªÉm t·ªëi ƒëa</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ƒêi·ªÉm th·∫•p nh·∫•t</div>
                            <div class="stat-number" id="statMinScore" style="font-size: 2rem; color: #f56565;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">ƒêi·ªÉm t·ªëi thi·ªÉu</div>
                        </div>
                    </div>

                    <!-- Th·ªëng k√™ b√†i thi -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìù Th·ªëng k√™ b√†i thi</h3>
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-label">B√†i ƒë√£ ch·∫•m</div>
                            <div class="stat-number" id="statGradedAttempts" style="font-size: 1.8rem; color: #48bb78;">
                                0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">Ho√†n th√†nh</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">B√†i ch·ªù ch·∫•m</div>
                            <div class="stat-number" id="statPendingAttempts"
                                style="font-size: 1.8rem; color: #f59e0b;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">ƒêang x·ª≠ l√Ω</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">T·ªïng b√†i l√†m</div>
                            <div class="stat-number" id="statTotalAttempts" style="font-size: 1.8rem; color: #2d3748;">0
                            </div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">T·∫•t c·∫£</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">T·ªïng c√¢u h·ªèi</div>
                            <div class="stat-number" id="statTotalQuestions" style="font-size: 1.8rem; color: #9f7aea;">
                                0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">Trong ng√¢n h√†ng</div>
                        </div>
                    </div>

                    <!-- Th·ªëng k√™ tr·∫°ng th√°i b√†i thi -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìã Tr·∫°ng th√°i b√†i thi</h3>
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-label">Nh√°p</div>
                            <div class="stat-number" id="statDraftExams" style="font-size: 1.5rem; color: #718096;">0
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">S·∫Øp di·ªÖn ra</div>
                            <div class="stat-number" id="statUpcomingExams" style="font-size: 1.5rem; color: #4299e1;">0
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ƒêang di·ªÖn ra</div>
                            <div class="stat-number" id="statActiveExams" style="font-size: 1.5rem; color: #48bb78;">0
                            </div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">ƒê√£ k·∫øt th√∫c</div>
                            <div class="stat-number" id="statCompletedExams" style="font-size: 1.5rem; color: #2d3748;">
                                0</div>
                        </div>
                    </div>

                    <!-- Th·ªëng k√™ h·ªçc sinh -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üë• Th·ªëng k√™ h·ªçc sinh</h3>
                    <div class="stats-grid" style="margin-bottom: 30px;">
                        <div class="stat-card">
                            <div class="stat-label">ƒê√£ l√†m b√†i thi</div>
                            <div class="stat-number" id="statStudentsWithExams"
                                style="font-size: 1.8rem; color: #48bb78;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">H·ªçc sinh t√≠ch c·ª±c</div>
                        </div>
                        <div class="stat-card">
                            <div class="stat-label">Ch∆∞a l√†m b√†i</div>
                            <div class="stat-number" id="statStudentsWithoutExams"
                                style="font-size: 1.8rem; color: #f56565;">0</div>
                            <div style="font-size: 0.85rem; color: #718096; margin-top: 5px;">C·∫ßn theo d√µi</div>
                        </div>
                    </div>

                    <!-- Top h·ªçc sinh -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üèÜ Top h·ªçc sinh xu·∫•t s·∫Øc</h3>
                    <div class="card" style="background: #f7fafc; padding: 20px; margin-bottom: 30px;">
                        <div id="topStudentsList" style="display: grid; gap: 10px;">
                            <p style="text-align: center; color: #718096;">‚è≥ ƒêang t·∫£i...</p>
                        </div>
                    </div>

                    <!-- Th·ªëng k√™ theo m√¥n h·ªçc -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìö Th·ªëng k√™ theo m√¥n h·ªçc</h3>
                    <div class="card" style="background: #f7fafc; padding: 20px; margin-bottom: 30px;">
                        <div id="subjectStatsList" style="display: grid; gap: 10px;">
                            <p style="text-align: center; color: #718096;">‚è≥ ƒêang t·∫£i...</p>
                        </div>
                    </div>

                    <!-- Top b√†i thi -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìù Top b√†i thi</h3>
                    <div class="card" style="background: #f7fafc; padding: 20px; margin-bottom: 30px;">
                        <div id="topExamsList" style="display: grid; gap: 10px;">
                            <p style="text-align: center; color: #718096;">‚è≥ ƒêang t·∫£i...</p>
                        </div>
                    </div>

                    <!-- Bi·ªÉu ƒë·ªì xu h∆∞·ªõng ƒëi·ªÉm s·ªë -->
                    <h3 style="color: #2d3748; margin: 20px 0 15px 0; font-size: 1.2rem;">üìà Xu h∆∞·ªõng ƒëi·ªÉm s·ªë (6 th√°ng
                        g·∫ßn nh·∫•t)</h3>
                    <div class="card" style="padding: 20px; margin-bottom: 30px;">
                        <div style="height: 300px;">
                            <canvas id="monthlyTrendChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>

            <!-- th√¥ng b√°o -->
            <div class="content-section" id="notifications">
                <!-- Tab chuy·ªÉn ƒë·ªïi gi·ªØa "G·ª≠i th√¥ng b√°o" v√† "Th√¥ng b√°o nh·∫≠n ƒë∆∞·ª£c" -->
                <div class="card" style="margin-bottom: 20px;">
                    <div class="class-tabs" style="border-bottom: 2px solid #e2e8f0; margin-bottom: 0;">
                        <button class="tab active" data-tab="send-notification" onclick="switchNotificationTab('send')">
                            üì§ G·ª≠i th√¥ng b√°o
                        </button>
                        <button class="tab" data-tab="received-notifications"
                            onclick="switchNotificationTab('received')">
                            üì• Th√¥ng b√°o nh·∫≠n ƒë∆∞·ª£c (<span id="unreadNotificationCount">0</span>)
                        </button>
                        <button class="tab" data-tab="sent-history" onclick="switchNotificationTab('sent')">
                            üìú L·ªãch s·ª≠ ƒë√£ g·ª≠i
                        </button>
                    </div>
                </div>

                <!-- Tab: G·ª≠i th√¥ng b√°o -->
                <div id="sendNotificationTab" class="notification-tab-content active">
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title">üì§ G·ª≠i th√¥ng b√°o cho h·ªçc sinh</h2>
                        </div>
                        <form id="sendNotificationForm" onsubmit="handleSendNotification(event)"
                            style="margin-top: 20px;">
                            <div class="form-group">
                                <label>Ti√™u ƒë·ªÅ th√¥ng b√°o <span style="color: #f56565;">*</span></label>
                                <input type="text" name="title" id="notificationTitle" required
                                    placeholder="VD: Th√¥ng b√°o l·ªãch thi cu·ªëi k·ª≥">
                            </div>

                            <div class="form-group">
                                <label>ƒê·ªëi t∆∞·ª£ng nh·∫≠n <span style="color: #f56565;">*</span></label>
                                <select name="recipients" id="notificationRecipients" required
                                    onchange="handleRecipientChange()">
                                    <option value="">-- Ch·ªçn ƒë·ªëi t∆∞·ª£ng --</option>
                                    <option value="all">üåç T·∫•t c·∫£ h·ªçc sinh</option>
                                    <option value="class">üè´ Theo l·ªõp h·ªçc</option>
                                    <option value="student">üë§ Theo h·ªçc sinh</option>
                                </select>
                            </div>

                            <!-- Ch·ªçn l·ªõp h·ªçc (hi·ªÉn th·ªã khi ch·ªçn "Theo l·ªõp") -->
                            <div class="form-group" id="classSelectGroup" style="display: none;">
                                <label>Ch·ªçn l·ªõp h·ªçc <span style="color: #f56565;">*</span></label>
                                <select name="classId" id="notificationClassSelect" multiple style="min-height: 100px;">
                                    <option value="">-- ƒêang t·∫£i danh s√°ch l·ªõp --</option>
                                </select>
                                <small style="color: #718096; display: block; margin-top: 5px;">
                                    üí° Gi·ªØ Ctrl (Windows) ho·∫∑c Cmd (Mac) ƒë·ªÉ ch·ªçn nhi·ªÅu l·ªõp
                                </small>
                            </div>

                            <!-- Ch·ªçn h·ªçc sinh (hi·ªÉn th·ªã khi ch·ªçn "Theo h·ªçc sinh") -->
                            <div class="form-group" id="studentSelectGroup" style="display: none;">
                                <label>Ch·ªçn h·ªçc sinh <span style="color: #f56565;">*</span></label>
                                <select name="studentIds" id="notificationStudentSelect" multiple
                                    style="min-height: 150px;">
                                    <option value="">-- Ch·ªçn l·ªõp tr∆∞·ªõc ƒë·ªÉ hi·ªÉn th·ªã h·ªçc sinh --</option>
                                </select>
                                <small style="color: #718096; display: block; margin-top: 5px;">
                                    üí° Gi·ªØ Ctrl (Windows) ho·∫∑c Cmd (Mac) ƒë·ªÉ ch·ªçn nhi·ªÅu h·ªçc sinh
                                </small>
                            </div>

                            <div class="form-group">
                                <label>N·ªôi dung th√¥ng b√°o <span style="color: #f56565;">*</span></label>
                                <textarea name="content" id="notificationContent" required
                                    placeholder="Nh·∫≠p n·ªôi dung th√¥ng b√°o chi ti·∫øt..." rows="6"></textarea>
                            </div>

                            <div
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div class="form-group">
                                    <label>M·ª©c ƒë·ªô ∆∞u ti√™n</label>
                                    <select name="priority" id="notificationPriority">
                                        <option value="normal">üü¢ B√¨nh th∆∞·ªùng</option>
                                        <option value="high">üü° Cao</option>
                                        <option value="urgent">üî¥ Kh·∫©n c·∫•p</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label>Lo·∫°i th√¥ng b√°o</label>
                                    <select name="type" id="notificationType">
                                        <option value="Info">‚ÑπÔ∏è Th√¥ng tin</option>
                                        <option value="Warning">‚ö†Ô∏è C·∫£nh b√°o</option>
                                        <option value="Success">‚úÖ Th√†nh c√¥ng</option>
                                        <option value="Error">‚ùå L·ªói</option>
                                    </select>
                                </div>
                            </div>

                            <div style="margin-top: 20px; display: flex; gap: 15px; flex-wrap: wrap;">
                                <button type="submit" class="btn btn-primary" id="sendNotificationBtn">
                                    üì§ G·ª≠i th√¥ng b√°o
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="resetNotificationForm()">
                                    üîÑ L√†m m·ªõi
                                </button>
                                <button type="button" class="btn btn-secondary" onclick="previewNotification()">
                                    üëÅÔ∏è Xem tr∆∞·ªõc
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Tab: Th√¥ng b√°o nh·∫≠n ƒë∆∞·ª£c -->
                <div id="receivedNotificationsTab" class="notification-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header"
                            style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h2 class="card-title">üì• Th√¥ng b√°o nh·∫≠n ƒë∆∞·ª£c</h2>
                            <div style="display: flex; gap: 10px; flex-wrap: wrap;">
                                <button class="btn btn-secondary" onclick="markAllNotificationsAsRead()">
                                    ‚úÖ ƒê√°nh d·∫•u t·∫•t c·∫£ ƒë√£ ƒë·ªçc
                                </button>
                                <button class="btn btn-secondary" onclick="fetchNotifications()">
                                    üîÑ L√†m m·ªõi
                                </button>
                            </div>
                        </div>

                        <div class="search-bar" style="margin-bottom: 15px;">
                            <input type="text" class="search-input" id="searchReceivedNotifications"
                                placeholder="üîç T√¨m ki·∫øm th√¥ng b√°o..." oninput="filterReceivedNotifications()">
                            <select id="filterNotificationType" onchange="filterReceivedNotifications()"
                                style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                <option value="all">T·∫•t c·∫£ lo·∫°i</option>
                                <option value="Info">‚ÑπÔ∏è Th√¥ng tin</option>
                                <option value="Warning">‚ö†Ô∏è C·∫£nh b√°o</option>
                                <option value="Success">‚úÖ Th√†nh c√¥ng</option>
                                <option value="Error">‚ùå L·ªói</option>
                            </select>
                            <select id="filterNotificationRead" onchange="filterReceivedNotifications()"
                                style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                <option value="all">T·∫•t c·∫£</option>
                                <option value="unread">üì¨ Ch∆∞a ƒë·ªçc</option>
                                <option value="read">üì≠ ƒê√£ ƒë·ªçc</option>
                            </select>
                        </div>

                        <div class="notification-list" id="receivedNotificationsList">
                            <div style="text-align: center; padding: 40px; color: #718096;">
                                <p>‚è≥ ƒêang t·∫£i th√¥ng b√°o...</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Tab: L·ªãch s·ª≠ ƒë√£ g·ª≠i -->
                <div id="sentHistoryTab" class="notification-tab-content" style="display: none;">
                    <div class="card">
                        <div class="card-header"
                            style="display: flex; justify-content: space-between; align-items: center; flex-wrap: wrap; gap: 15px;">
                            <h2 class="card-title">üìú L·ªãch s·ª≠ th√¥ng b√°o ƒë√£ g·ª≠i</h2>
                            <button class="btn btn-secondary" onclick="loadSentNotifications()">
                                üîÑ L√†m m·ªõi
                            </button>
                        </div>

                        <div class="search-bar" style="margin-bottom: 15px;">
                            <input type="text" class="search-input" id="searchSentNotifications"
                                placeholder="üîç T√¨m ki·∫øm th√¥ng b√°o ƒë√£ g·ª≠i..." oninput="filterSentNotifications()">
                            <select id="filterSentPriority" onchange="filterSentNotifications()"
                                style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                <option value="all">T·∫•t c·∫£ m·ª©c ƒë·ªô</option>
                                <option value="normal">üü¢ B√¨nh th∆∞·ªùng</option>
                                <option value="high">üü° Cao</option>
                                <option value="urgent">üî¥ Kh·∫©n c·∫•p</option>
                            </select>
                            <select id="filterSentClass" onchange="filterSentNotifications()"
                                style="padding: 12px; border: 2px solid #e2e8f0; border-radius: 8px;">
                                <option value="all">T·∫•t c·∫£ l·ªõp</option>
                            </select>
                        </div>

                        <div id="sentNotificationsList" class="notification-list">
                            <div style="text-align: center; padding: 40px; color: #718096;">
                                <p>‚è≥ ƒêang t·∫£i l·ªãch s·ª≠...</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- Edit Question Modal (NGO√ÄI main-content) -->
    <div id="editQuestionModal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn" onclick="closeEditQuestionModal()">&times;</span>
            <h2>Ch·ªânh s·ª≠a c√¢u h·ªèi</h2>
            <form id="editQuestionForm" onsubmit="handleEditQuestion(event)">
                <input type="hidden" name="examId">
                <input type="hidden" name="questionId">
                <div class="form-group">
                    <label>N·ªôi dung c√¢u h·ªèi <span style="color: #f56565;">*</span></label>
                    <textarea name="questionContent" required rows="4" placeholder="N·ªôi dung c√¢u h·ªèi..."></textarea>
                </div>
                <div class="form-group">
                    <label>Lo·∫°i c√¢u h·ªèi</label>
                    <select name="questionType" disabled>
                        <option value="SingleChoice">Tr·∫Øc nghi·ªám 1 ƒë√°p √°n</option>
                        <option value="MultipleChoice">Tr·∫Øc nghi·ªám nhi·ªÅu ƒë√°p √°n</option>
                        <option value="FillInBlank">ƒêi·ªÅn v√†o ch·ªó tr·ªëng</option>
                        <option value="Essay">T·ª± lu·∫≠n</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>ƒê·ªô kh√≥</label>
                    <select name="difficulty">
                        <option value="Easy">D·ªÖ</option>
                        <option value="Medium">Trung b√¨nh</option>
                        <option value="Hard">Kh√≥</option>
                    </select>
                </div>
                <div id="optionsContainer" class="form-group">
                    <label>ƒê√°p √°n</label>
                    <div id="optionsList"></div>
                    <button type="button" class="btn btn-secondary" onclick="addOption()">+ Th√™m ƒë√°p √°n</button>
                </div>
                <div class="form-group">
                    <label>ƒê√°p √°n ƒë√∫ng <span style="color: #f56565;">*</span></label>
                    <input type="text" name="correctAnswerText" required
                        placeholder="VD: A ho·∫∑c A,B,C (cho MultipleChoice)">
                </div>
                <div style="margin-top: 20px;">
                    <button type="submit" class="btn btn-primary">üíæ L∆∞u c√¢u h·ªèi</button>
                    <button type="button" class="btn btn-secondary" onclick="closeEditQuestionModal()">H·ªßy</button>
                </div>
            </form>
        </div>
    </div>
    <div id="toast" class="toast">
        <span id="toastMessage"></span>
    </div>

    <!-- Modal chi ti·∫øt b√†i thi -->
    <div id="examDetailModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 1000px; max-height: 90vh; overflow-y: auto;">
            <div class="modal-header">
                <h3 id="examDetailModalTitle">üìã Chi ti·∫øt b√†i thi</h3>
                <span class="close" onclick="closeExamDetailModal()">&times;</span>
            </div>
            <div id="examDetailModalContent" style="padding: 25px;">
                <div style="text-align: center; padding: 40px;">
                    <p>‚è≥ ƒêang t·∫£i th√¥ng tin...</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal hi·ªÉn th·ªã m√£ code b√†i thi -->
    <div id="examCodeModal" class="modal" style="display: none;">
        <div class="modal-content" style="max-width: 500px;">
            <div class="modal-header">
                <h3>üîê M√£ code b√†i thi</h3>
                <span class="close" onclick="closeExamCodeModal()">&times;</span>
            </div>
            <div style="padding: 30px; text-align: center;">
                <p style="margin-bottom: 20px; color: #666; font-size: 14px;">B√†i thi ƒë√£ ƒë∆∞·ª£c t·∫°o th√†nh c√¥ng! Vui l√≤ng
                    cung c·∫•p m√£ code n√†y cho h·ªçc sinh ƒë·ªÉ h·ªç c√≥ th·ªÉ l√†m b√†i thi.</p>

                <div style="background: #4a5568; color: white; padding: 25px; border-radius: 8px; margin-bottom: 20px;">
                    <p style="color: rgba(255,255,255,0.9); font-size: 14px; margin-bottom: 10px; font-weight: 500;">M√£
                        code b√†i thi:</p>
                    <div id="examCodeDisplay"
                        style="font-size: 36px; font-weight: bold; color: white; letter-spacing: 8px; font-family: 'Courier New', monospace; margin: 10px 0;">
                        000000</div>
                    <p id="examCodeName"
                        style="color: rgba(255,255,255,0.9); font-size: 16px; margin-top: 10px; font-weight: 500;"></p>
                </div>

                <button id="copyCodeBtn" class="btn btn-primary"
                    style="width: 100%; padding: 15px; font-size: 16px; font-weight: 600;" onclick="copyExamCode()">
                    üìã Copy m√£ code
                </button>

                <div id="copySuccessMsg" style="margin-top: 15px; color: #48bb78; font-weight: 600; display: none;">
                    ‚úÖ ƒê√£ copy m√£ code v√†o clipboard!
                </div>
            </div>
        </div>
    </div>


    <div id="aiExamModal" class="ai-modal">
        <div class="ai-modal-content">
            <div class="ai-modal-header">
                <h2>ü§ñ T·∫°o ƒê·ªÅ Thi v·ªõi AI</h2>
                <button class="ai-modal-close" onclick="closeAIModal()">&times;</button>
            </div>
            <div class="ai-modal-body">
                <!-- Alert Container -->
                <div id="aiAlertContainer"></div>

                <!-- Form nh·∫≠p th√¥ng tin -->
                <form id="aiExamForm" style="display: block;">
                    <div class="ai-grid">
                        <div class="ai-form-group">
                            <label>üìö Ch·ªß ƒë·ªÅ/M√¥n h·ªçc <span class="required">*</span></label>
                            <input type="text" id="aiSubject" placeholder="VD: To√°n h·ªçc, L·ªãch s·ª≠..." required>
                        </div>

                        <div class="ai-form-group">
                            <label>üìñ N·ªôi dung c·ª• th·ªÉ <span class="required">*</span></label>
                            <input type="text" id="aiTopic" placeholder="VD: Ph∆∞∆°ng tr√¨nh b·∫≠c 2..." required>
                        </div>
                    </div>

                    <div class="ai-grid">
                        <div class="ai-form-group">
                            <label>üî¢ S·ªë l∆∞·ª£ng c√¢u h·ªèi <span class="required">*</span></label>
                            <input type="number" id="aiNumQuestions" min="5" max="30" value="10" required>
                        </div>

                        <div class="ai-form-group">
                            <label>üìä ƒê·ªô kh√≥ <span class="required">*</span></label>
                            <select id="aiDifficulty" required>
                                <option value="easy">üü¢ D·ªÖ</option>
                                <option value="medium" selected>üü° Trung b√¨nh</option>
                                <option value="hard">üî¥ Kh√≥</option>
                                <option value="mixed">üé® H·ªón h·ª£p</option>
                            </select>
                        </div>
                    </div>

                    <div class="ai-form-group">
                        <label>‚ùì Lo·∫°i c√¢u h·ªèi <span class="required">*</span></label>
                        <div class="ai-checkbox-group">
                            <label class="ai-checkbox-label">
                                <input type="checkbox" name="aiQuestionType" value="SingleChoice" checked>
                                <span>Tr·∫Øc nghi·ªám 1 ƒë√°p √°n</span>
                            </label>
                            <label class="ai-checkbox-label">
                                <input type="checkbox" name="aiQuestionType" value="MultipleChoice">
                                <span>Tr·∫Øc nghi·ªám nhi·ªÅu ƒë√°p √°n</span>
                            </label>
                            <label class="ai-checkbox-label">
                                <input type="checkbox" name="aiQuestionType" value="FillInBlank">
                                <span>ƒêi·ªÅn v√†o ch·ªó tr·ªëng</span>
                            </label>
                            <label class="ai-checkbox-label">
                                <input type="checkbox" name="aiQuestionType" value="Essay">
                                <span>T·ª± lu·∫≠n</span>
                            </label>
                        </div>
                    </div>

                    <div class="ai-form-group">
                        <label>üí° Y√™u c·∫ßu b·ªï sung (t√πy ch·ªçn)</label>
                        <textarea id="aiAdditional"
                            placeholder="VD: T·∫≠p trung v√†o ph·∫ßn l√Ω thuy·∫øt, c√≥ c√¢u h·ªèi th·ª±c t·∫ø..."></textarea>
                    </div>

                    <div class="ai-form-group">
                        <label>üè´ Ch·ªçn l·ªõp h·ªçc ƒë·ªÉ g·∫Øn b√†i thi <span class="required">*</span></label>
                        <select id="aiClassSelect" required>
                            <option value="">-- Ch·ªçn l·ªõp --</option>
                        </select>
                    </div>

                    <div class="ai-grid">
                        <div class="ai-form-group">
                            <label>üìÖ Ng√†y thi <span class="required">*</span></label>
                            <input type="date" id="aiExamDate" required>
                        </div>

                        <div class="ai-form-group">
                            <label>‚è∞ Gi·ªù b·∫Øt ƒë·∫ßu <span class="required">*</span></label>
                            <input type="time" id="aiExamTime" required value="08:00">
                        </div>
                    </div>

                    <div class="ai-grid">
                        <div class="ai-form-group">
                            <label>‚è±Ô∏è Th·ªùi gian l√†m b√†i (ph√∫t) <span class="required">*</span></label>
                            <input type="number" id="aiExamDuration" min="1" value="60" required>
                        </div>

                        <div class="ai-form-group">
                            <label>‚≠ê ƒêi·ªÉm t·ªëi ƒëa <span class="required">*</span></label>
                            <input type="number" id="aiMaxPoints" min="1" value="10" required>
                            <small style="color: #718096; display: block; margin-top: 5px; font-size: 0.85rem;">
                                T·ªïng ƒëi·ªÉm t·ªëi ƒëa c·ªßa b√†i thi (s·∫Ω chia ƒë·ªÅu cho c√°c c√¢u h·ªèi)
                            </small>
                        </div>
                    </div>

                    <div class="ai-form-group">
                        <label>üìù M√¥ t·∫£ b√†i thi</label>
                        <input type="text" id="aiExamDescription" placeholder="M√¥ t·∫£ v·ªÅ b√†i thi...">
                    </div>

                    <div class="ai-form-group">
                        <label style="font-weight: 600; margin-bottom: 12px; display: block; color: #2d3748;">üîÄ X√°o
                            tr·ªôn</label>
                        <div class="shuffle-options">
                            <label class="shuffle-checkbox-label">
                                <input type="checkbox" id="aiShuffleQuestions" value="1" class="shuffle-checkbox">
                                <span>X√°o tr·ªôn th·ª© t·ª± c√¢u h·ªèi</span>
                            </label>
                            <label class="shuffle-checkbox-label">
                                <input type="checkbox" id="aiShuffleOptions" value="1" class="shuffle-checkbox">
                                <span>X√°o tr·ªôn th·ª© t·ª± ƒë√°p √°n</span>
                            </label>
                        </div>
                        <small
                            style="color: #718096; display: block; margin-top: 10px; font-size: 0.85rem; line-height: 1.4;">
                            M·ªói h·ªçc sinh s·∫Ω nh·∫≠n th·ª© t·ª± c√¢u h·ªèi/ƒë√°p √°n kh√°c nhau ƒë·ªÉ tr√°nh gian l·∫≠n
                        </small>
                    </div>

                    <div class="ai-actions">
                        <button type="submit" class="ai-btn ai-btn-primary" id="aiGenerateBtn">
                            <span>‚ú®</span> T·∫°o ƒë·ªÅ thi v·ªõi AI
                        </button>
                        <button type="button" class="ai-btn ai-btn-secondary" onclick="resetAIForm()">
                            <span>üîÑ</span> L√†m m·ªõi
                        </button>
                    </div>
                </form>

                <!-- Loading -->
                <div id="aiLoading" class="ai-loading">
                    <div class="ai-spinner"></div>
                    <p style="color: #2d3748; font-size: 16px; font-weight: 600;">
                        ƒêang t·∫°o ƒë·ªÅ thi v·ªõi AI...
                    </p>
                    <p style="color: #718096; margin-top: 10px; font-size: 14px;">
                        Vui l√≤ng ƒë·ª£i trong gi√¢y l√°t
                    </p>
                </div>

                <!-- K·∫øt qu·∫£ -->
                <div id="aiResult" class="ai-result">
                    <div class="ai-stats">
                        <div class="ai-stat-card">
                            <div class="ai-stat-number" id="aiStatTotal">0</div>
                            <div class="ai-stat-label">C√¢u h·ªèi</div>
                        </div>
                        <div class="ai-stat-card">
                            <div class="ai-stat-number" id="aiStatPoints">0</div>
                            <div class="ai-stat-label">T·ªïng ƒëi·ªÉm</div>
                        </div>
                        <div class="ai-stat-card">
                            <div class="ai-stat-number" id="aiStatChoice">0</div>
                            <div class="ai-stat-label">Tr·∫Øc nghi·ªám</div>
                        </div>
                        <div class="ai-stat-card">
                            <div class="ai-stat-number" id="aiStatOther">0</div>
                            <div class="ai-stat-label">T·ª± lu·∫≠n</div>
                        </div>
                    </div>

                    <h3 style="margin-bottom: 15px; color: #2d3748;">üìã Xem tr∆∞·ªõc ƒë·ªÅ thi</h3>
                    <div id="aiPreviewList" class="ai-preview-list"></div>

                    <div class="ai-actions">
                        <button class="ai-btn ai-btn-primary" onclick="saveAIExam()">
                            <span>üíæ</span> L∆∞u ƒë·ªÅ thi
                        </button>
                        <button class="ai-btn ai-btn-secondary" onclick="downloadAIJSON()">
                            <span>üì•</span> T·∫£i JSON
                        </button>
                        <button class="ai-btn ai-btn-secondary" onclick="resetAIModal()">
                            <span>üîÑ</span> T·∫°o ƒë·ªÅ m·ªõi
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>

</html>